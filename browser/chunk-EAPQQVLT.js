import{a as oe}from"./chunk-SC5XULAK.js";import{a as W,b as q}from"./chunk-RH2RXJ72.js";import{b as _e}from"./chunk-IL6RBSH4.js";import{b as be}from"./chunk-U2VHYGUJ.js";import{b as ve}from"./chunk-U3SUU6ME.js";import"./chunk-IKOAZ4YC.js";import{a as L,b as D,c as A,d as R,e as ae,f as le,g as j,h as se,i as de,j as me,o as ce,p as pe,q as ue,r as ge,s as B,t as fe,u as xe}from"./chunk-N37MMRHP.js";import{$ as S,Aa as _,Ca as m,D as T,Ia as k,J as p,Ja as r,K as u,Ka as f,L as P,La as v,M as I,Na as C,Oa as y,Pa as w,Sa as Q,Ta as X,Va as ee,Wa as te,Xa as ie,Y as E,_ as l,a as J,c as K,e as $,eb as O,fb as ne,ga as V,gb as N,ha as U,hb as re,jb as M,la as g,pa as d,ta as i,ua as t,va as x,vb as F,ya as b}from"./chunk-IYLSK3UX.js";var h=$(xe());var he=(n,o)=>({"bg-indigo-600 hover:bg-indigo-700 text-white":n,"bg-gray-300 hover:bg-gray-400 text-gray-700":o}),Ce=n=>({"opacity-50 cursor-not-allowed":n});function Ee(n,o){n&1&&(i(0,"div",11),x(1,"div",12),t())}function Me(n,o){if(n&1&&x(0,"img",48),n&2){let e=m(3);d("src",e.imagePreview||"http://localhost:8080/api/uploads/"+e.userProfile.image,E)}}function Ie(n,o){if(n&1&&(i(0,"div",49)(1,"span",50),r(2),t()()),n&2){let e=m(3);l(2),f(e.userProfile.name.charAt(0).toUpperCase())}}function Fe(n,o){if(n&1){let e=b();i(0,"form",26,1),_("ngSubmit",function(){p(e);let s=m(2);return u(s.updateProfile())}),i(2,"div",27)(3,"div",28),g(4,Me,1,1,"img",29)(5,Ie,3,1,"div",30),t(),i(6,"label",31)(7,"input",32),_("change",function(s){p(e);let c=m(2);return u(c.onFileSelected(s))}),t(),r(8),t()(),i(9,"div",33)(10,"div")(11,"h3",34),r(12,"Personal Information"),t(),i(13,"div",35)(14,"label",36),r(15,"Full Name"),t(),i(16,"input",37),w("ngModelChange",function(s){p(e);let c=m(2);return y(c.userProfile.name,s)||(c.userProfile.name=s),u(s)}),t()(),i(17,"div",35)(18,"label",38),r(19,"Email Address"),t(),i(20,"input",39),w("ngModelChange",function(s){p(e);let c=m(2);return y(c.userProfile.email,s)||(c.userProfile.email=s),u(s)}),t()(),i(21,"div",35)(22,"label",40),r(23,"Date of Birth"),t(),i(24,"input",41),w("ngModelChange",function(s){p(e);let c=m(2);return y(c.userProfile.birthday,s)||(c.userProfile.birthday=s),u(s)}),t()()(),i(25,"div")(26,"h3",34),r(27,"Contact Information"),t(),i(28,"div",35)(29,"label",42),r(30,"Phone Number"),t(),i(31,"input",43),w("ngModelChange",function(s){p(e);let c=m(2);return y(c.userProfile.phone,s)||(c.userProfile.phone=s),u(s)}),t()(),i(32,"div",35)(33,"label",44),r(34,"Address"),t(),i(35,"textarea",45),w("ngModelChange",function(s){p(e);let c=m(2);return y(c.userProfile.address,s)||(c.userProfile.address=s),u(s)}),t()()()(),i(36,"div",46)(37,"button",47),r(38," Save Changes "),t()()()}if(n&2){let e=k(1),a=m(2);l(4),d("ngIf",a.imagePreview||a.userProfile.image),l(),d("ngIf",!a.imagePreview&&!a.userProfile.image),l(3),v(" ",a.userProfile.image?"Change Photo":"Upload Photo"," "),l(8),C("ngModel",a.userProfile.name),l(4),C("ngModel",a.userProfile.email),l(4),C("ngModel",a.userProfile.birthday),l(7),C("ngModel",a.userProfile.phone),l(4),C("ngModel",a.userProfile.address),l(2),d("disabled",!e.valid)("ngClass",Q(10,Ce,!e.valid))}}function De(n,o){if(n&1&&x(0,"img",48),n&2){let e=m(3);d("src","http://localhost:8080/api/uploads/"+e.userProfile.image,E)}}function Te(n,o){if(n&1&&(i(0,"div",49)(1,"span",50),r(2),t()()),n&2){let e=m(3);l(2),f(e.userProfile.name.charAt(0).toUpperCase())}}function Ve(n,o){if(n&1&&(i(0,"div",35)(1,"p",53),r(2,"Age"),t(),i(3,"p",54),r(4),t()()),n&2){let e=m(3);l(4),v("",e.calculateAge(e.userProfile.birthday)," years")}}function Ue(n,o){if(n&1&&(i(0,"div")(1,"div",51)(2,"div",52)(3,"div",28),g(4,De,1,1,"img",29)(5,Te,3,1,"div",30),t()(),i(6,"div")(7,"h3",34),r(8,"Personal Information"),t(),i(9,"div",35)(10,"p",53),r(11,"Full Name"),t(),i(12,"p",54),r(13),t()(),i(14,"div",35)(15,"p",53),r(16,"Email"),t(),i(17,"p",54),r(18),t()(),i(19,"div",35)(20,"p",53),r(21,"Date of Birth"),t(),i(22,"p",54),r(23),ee(24,"date"),t()(),g(25,Ve,5,1,"div",55),t(),i(26,"div")(27,"h3",34),r(28,"Contact Information"),t(),i(29,"div",35)(30,"p",53),r(31,"Phone"),t(),i(32,"p",54),r(33),t()(),i(34,"div",35)(35,"p",53),r(36,"Address"),t(),i(37,"p",56),r(38),t()()()()()),n&2){let e=m(2);l(4),d("ngIf",e.userProfile.image),l(),d("ngIf",!e.userProfile.image),l(8),f(e.userProfile.name),l(5),f(e.userProfile.email),l(5),f(e.userProfile.birthday?te(24,8,e.userProfile.birthday,"mediumDate"):"Not provided"),l(2),d("ngIf",e.userProfile.birthday),l(8),f(e.userProfile.phone||"Not provided"),l(5),f(e.userProfile.address||"Not provided")}}function ke(n,o){if(n&1){let e=b();i(0,"form",26,2),_("ngSubmit",function(){p(e);let s=m(2);return u(s.changePassword())}),i(2,"div",35)(3,"label",57),r(4,"Current Password"),t(),i(5,"input",58),w("ngModelChange",function(s){p(e);let c=m(2);return y(c.currentPassword,s)||(c.currentPassword=s),u(s)}),t()(),i(6,"div",35)(7,"label",59),r(8,"New Password"),t(),i(9,"input",60),w("ngModelChange",function(s){p(e);let c=m(2);return y(c.newPassword,s)||(c.newPassword=s),u(s)}),t(),i(10,"p",61),r(11,"Password must be at least 8 characters long"),t()(),i(12,"div",35)(13,"label",62),r(14,"Confirm New Password"),t(),i(15,"input",63),w("ngModelChange",function(s){p(e);let c=m(2);return y(c.confirmPassword,s)||(c.confirmPassword=s),u(s)}),t()(),i(16,"div",46)(17,"button",47),r(18," Update Password "),t()()()}if(n&2){let e=k(1),a=m(2);l(5),C("ngModel",a.currentPassword),l(4),C("ngModel",a.newPassword),l(6),C("ngModel",a.confirmPassword),l(2),d("disabled",!e.valid||a.newPassword!==a.confirmPassword)("ngClass",Q(5,Ce,!e.valid||a.newPassword!==a.confirmPassword))}}function Oe(n,o){n&1&&(i(0,"div")(1,"p",64),r(2,"Your password can be updated using the button above."),t(),i(3,"p",65),r(4,"For security reasons, we recommend changing your password regularly and using a strong, unique password."),t()())}function Ne(n,o){if(n&1&&(i(0,"div")(1,"p",53),r(2,"Policy"),t(),i(3,"p",69),r(4),t()()),n&2){let e=m(3);l(4),f(e.policyDetails.name)}}function Le(n,o){if(n&1&&(i(0,"div")(1,"p",53),r(2,"End Date"),t(),i(3,"p",69),r(4),t()()),n&2){let e=m(3);l(4),f(e.formatDate(e.subscription.endDate))}}function Ae(n,o){if(n&1&&(i(0,"div")(1,"p",53),r(2,"Coverage"),t(),i(3,"p",69),r(4),t()()),n&2){let e=m(3);l(4),v("",e.policyDetails.percentage,"%")}}function Re(n,o){if(n&1){let e=b();i(0,"div",71)(1,"button",72),_("click",function(){p(e);let s=m(3);return u(s.cancelSubscription())}),r(2," Cancel Subscription "),t()()}}function je(n,o){n&1&&(i(0,"div",71)(1,"a",73),r(2," Browse Policies "),t()())}function Be(n,o){if(n&1&&(i(0,"div")(1,"div",66)(2,"span",67),r(3),t()(),i(4,"div",68),g(5,Ne,5,1,"div",21),i(6,"div")(7,"p",53),r(8,"Start Date"),t(),i(9,"p",69),r(10),t()(),g(11,Le,5,1,"div",21)(12,Ae,5,1,"div",21)(13,Re,3,0,"div",70)(14,je,3,0,"div",70),t()()),n&2){let e=m(2);l(2),d("ngClass",e.getSubscriptionStatusClass()),l(),v(" ",e.getSubscriptionStatus()," "),l(2),d("ngIf",e.policyDetails),l(5),f(e.formatDate(e.subscription.subscriptionDate)),l(),d("ngIf",e.subscription.endDate),l(),d("ngIf",e.policyDetails),l(),d("ngIf",e.subscription.status==="ACTIVE"),l(),d("ngIf",e.subscription.status==="CANCELED")}}function We(n,o){n&1&&(i(0,"div",74),P(),i(1,"svg",75),x(2,"path",76),t(),I(),i(3,"h3",77),r(4,"No Active Subscription"),t(),i(5,"p",78),r(6,"You don't have an active insurance policy subscription yet."),t(),i(7,"a",73),r(8," Browse Policies "),t()())}function qe(n,o){if(n&1){let e=b();i(0,"div",13)(1,"div",14)(2,"div",15)(3,"div",16)(4,"h2",17),r(5,"Profile Information"),t(),i(6,"button",18),_("click",function(){p(e);let s=m();return u(s.toggleEditMode())}),r(7),t()(),i(8,"div",19),g(9,Fe,39,12,"form",20)(10,Ue,39,11,"div",21),t()(),i(11,"div",22)(12,"div",16)(13,"h2",17),r(14,"Security"),t(),i(15,"button",18),_("click",function(){p(e);let s=m();return u(s.togglePasswordChangeMode())}),r(16),t()(),i(17,"div",19),g(18,ke,19,7,"form",20)(19,Oe,5,0,"div",21),t()()(),i(20,"div",23)(21,"div",15)(22,"div",24)(23,"h2",17),r(24,"Subscription Details"),t()(),i(25,"div",19),g(26,Be,15,8,"div",25)(27,We,9,0,"ng-template",null,0,ie),t()()()()}if(n&2){let e=k(28),a=m();l(6),d("ngClass",X(10,he,!a.isEditMode,a.isEditMode)),l(),v(" ",a.isEditMode?"Cancel":"Edit Profile"," "),l(2),d("ngIf",a.isEditMode),l(),d("ngIf",!a.isEditMode),l(5),d("ngClass",X(13,he,!a.isPasswordChangeMode,a.isPasswordChangeMode)),l(),v(" ",a.isPasswordChangeMode?"Cancel":"Change Password"," "),l(2),d("ngIf",a.isPasswordChangeMode),l(),d("ngIf",!a.isPasswordChangeMode),l(7),d("ngIf",a.subscription)("ngIfElse",e)}}var G=class n{constructor(o,e,a){this.userService=o;this.subscriptionService=e;this.policyService=a}userProfile={name:"",email:"",birthday:"",address:"",phone:"",role:"CLIENT"};subscription=null;policyDetails=null;isLoading=!0;isEditMode=!1;isPasswordChangeMode=!1;originalProfile=null;selectedFile=null;imagePreview=null;currentPassword="";newPassword="";confirmPassword="";ngOnInit(){this.loadUserProfile(),this.loadSubscriptionDetails()}loadUserProfile(){this.isLoading=!0,this.userService.getUserProfile().subscribe({next:o=>{let s=o,{password:e}=s,a=K(s,["password"]);this.userProfile=a,this.isLoading=!1},error:o=>{console.error("Error loading user profile:",o),this.isLoading=!1,h.default.fire({title:"Error",text:"Failed to load your profile information. Please try again later.",icon:"error"})}})}loadSubscriptionDetails(){this.subscriptionService.getMySubscription().subscribe({next:o=>{this.subscription=o,o&&o.policyId&&this.loadPolicyDetails(o.policyId)},error:o=>{console.error("Error loading subscription details:",o)}})}loadPolicyDetails(o){this.policyService.getPolicyById(o).subscribe({next:e=>{this.policyDetails=e},error:e=>{console.error("Error loading policy details:",e)}})}toggleEditMode(){this.isEditMode?(this.originalProfile&&(this.userProfile=J({},this.originalProfile)),this.isEditMode=!1,this.selectedFile=null,this.imagePreview=null):(this.originalProfile=J({},this.userProfile),this.isEditMode=!0)}togglePasswordChangeMode(){this.isPasswordChangeMode=!this.isPasswordChangeMode,this.isPasswordChangeMode||(this.currentPassword="",this.newPassword="",this.confirmPassword="")}onFileSelected(o){let e=o.target;if(!e.files||e.files.length===0)return;this.selectedFile=e.files[0];let a=new FileReader;a.onload=()=>{this.imagePreview=a.result},a.readAsDataURL(this.selectedFile)}updateProfile(){let o={name:this.userProfile.name,email:this.userProfile.email,birthday:this.userProfile.birthday,address:this.userProfile.address,phone:this.userProfile.phone};this.userService.updateProfile(o,this.selectedFile||void 0).subscribe({next:e=>{let c=e,{password:a}=c,s=K(c,["password"]);this.userProfile=s,this.isEditMode=!1,this.selectedFile=null,this.imagePreview=null,h.default.fire({title:"Success!",text:"Your profile has been updated successfully.",icon:"success"})},error:e=>{console.error("Error updating profile:",e),h.default.fire({title:"Error",text:"Failed to update your profile. Please try again later.",icon:"error"})}})}changePassword(){if(this.newPassword!==this.confirmPassword){h.default.fire({title:"Error",text:"New password and confirmation do not match.",icon:"error"});return}let o={password:this.newPassword};this.userService.updateProfile(o).subscribe({next:()=>{this.isPasswordChangeMode=!1,this.currentPassword="",this.newPassword="",this.confirmPassword="",h.default.fire({title:"Success!",text:"Your password has been changed successfully.",icon:"success"})},error:e=>{console.error("Error changing password:",e),h.default.fire({title:"Error",text:"Failed to change your password. Please try again.",icon:"error"})}})}cancelSubscription(){!this.subscription||!this.subscription.id||h.default.fire({title:"Cancel Subscription",text:"Are you sure you want to cancel your subscription? This action cannot be undone.",icon:"warning",showCancelButton:!0,confirmButtonText:"Yes, cancel my subscription",cancelButtonText:"No, keep my subscription"}).then(o=>{o.isConfirmed&&this.subscriptionService.cancelSubscription(this.subscription.id).subscribe({next:()=>{h.default.fire({title:"Subscription Canceled",text:"Your subscription has been canceled successfully.",icon:"success"}),this.loadSubscriptionDetails()},error:e=>{console.error("Error canceling subscription:",e),h.default.fire({title:"Error",text:"Failed to cancel your subscription. Please try again later.",icon:"error"})}})})}calculateAge(o){if(!o)return 0;let e=new Date(o),a=new Date,s=a.getFullYear()-e.getFullYear(),c=a.getMonth()-e.getMonth();return(c<0||c===0&&a.getDate()<e.getDate())&&s--,s}getSubscriptionStatus(){return this.subscription?.status||"No Active Subscription"}getSubscriptionStatusClass(){if(!this.subscription)return"bg-gray-100 text-gray-800";switch(this.subscription.status){case"ACTIVE":return"bg-green-100 text-green-800";case"CANCELED":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}}formatDate(o){return o?new Date(o).toLocaleDateString():"N/A"}static \u0275fac=function(e){return new(e||n)(S(oe),S(ve),S(_e))};static \u0275cmp=V({type:n,selectors:[["app-profile"]],decls:13,vars:2,consts:[["noSubscription",""],["profileForm","ngForm"],["passwordForm","ngForm"],[1,"min-h-screen","bg-gray-50","py-8"],[1,"container","mx-auto","px-4"],[1,"bg-white","rounded-lg","shadow-md","p-6","mb-6"],[1,"flex","justify-between","items-center"],[1,"text-2xl","font-bold","text-gray-800"],[1,"text-gray-600"],["class","flex justify-center py-12",4,"ngIf"],["class","grid grid-cols-1 md:grid-cols-3 gap-6",4,"ngIf"],[1,"flex","justify-center","py-12"],[1,"loader"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-6"],[1,"md:col-span-2"],[1,"bg-white","rounded-lg","shadow-md","overflow-hidden"],[1,"px-6","py-4","border-b","border-gray-200","flex","justify-between","items-center"],[1,"text-lg","font-semibold","text-gray-700"],[1,"px-4","py-2","rounded-lg","text-sm","font-medium","transition-colors",3,"click","ngClass"],[1,"p-6"],[3,"ngSubmit",4,"ngIf"],[4,"ngIf"],[1,"bg-white","rounded-lg","shadow-md","overflow-hidden","mt-6"],[1,"md:col-span-1"],[1,"px-6","py-4","border-b","border-gray-200"],[4,"ngIf","ngIfElse"],[3,"ngSubmit"],[1,"mb-6","flex","flex-col","items-center"],[1,"w-32","h-32","rounded-full","overflow-hidden","border-2","border-gray-200","mb-3"],["alt","Profile Image","class","w-full h-full object-cover",3,"src",4,"ngIf"],["class","w-full h-full bg-gray-100 flex items-center justify-center",4,"ngIf"],[1,"cursor-pointer","px-4","py-2","bg-gray-100","text-gray-700","rounded-lg","hover:bg-gray-200","transition-colors"],["type","file","accept","image/*",1,"hidden",3,"change"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-6"],[1,"text-md","font-semibold","mb-4","text-gray-700"],[1,"mb-4"],["for","name",1,"block","text-sm","font-medium","text-gray-700","mb-1"],["type","text","id","name","name","name","required","",1,"w-full","px-4","py-2","border","border-gray-300","rounded-lg","focus:ring-indigo-500","focus:border-indigo-500",3,"ngModelChange","ngModel"],["for","email",1,"block","text-sm","font-medium","text-gray-700","mb-1"],["type","email","id","email","name","email","required","",1,"w-full","px-4","py-2","border","border-gray-300","rounded-lg","focus:ring-indigo-500","focus:border-indigo-500",3,"ngModelChange","ngModel"],["for","birthday",1,"block","text-sm","font-medium","text-gray-700","mb-1"],["type","date","id","birthday","name","birthday",1,"w-full","px-4","py-2","border","border-gray-300","rounded-lg","focus:ring-indigo-500","focus:border-indigo-500",3,"ngModelChange","ngModel"],["for","phone",1,"block","text-sm","font-medium","text-gray-700","mb-1"],["type","tel","id","phone","name","phone",1,"w-full","px-4","py-2","border","border-gray-300","rounded-lg","focus:ring-indigo-500","focus:border-indigo-500",3,"ngModelChange","ngModel"],["for","address",1,"block","text-sm","font-medium","text-gray-700","mb-1"],["id","address","name","address","rows","3",1,"w-full","px-4","py-2","border","border-gray-300","rounded-lg","focus:ring-indigo-500","focus:border-indigo-500",3,"ngModelChange","ngModel"],[1,"mt-6","flex","justify-end"],["type","submit",1,"px-4","py-2","bg-indigo-600","text-white","rounded-lg","hover:bg-indigo-700","focus:outline-none","transition-colors",3,"disabled","ngClass"],["alt","Profile Image",1,"w-full","h-full","object-cover",3,"src"],[1,"w-full","h-full","bg-gray-100","flex","items-center","justify-center"],[1,"text-3xl","text-gray-400"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-8"],[1,"flex","flex-col","items-center"],[1,"text-sm","text-gray-500"],[1,"font-medium"],["class","mb-4",4,"ngIf"],[1,"font-medium","whitespace-pre-line"],["for","currentPassword",1,"block","text-sm","font-medium","text-gray-700","mb-1"],["type","password","id","currentPassword","name","currentPassword","required","",1,"w-full","px-4","py-2","border","border-gray-300","rounded-lg","focus:ring-indigo-500","focus:border-indigo-500",3,"ngModelChange","ngModel"],["for","newPassword",1,"block","text-sm","font-medium","text-gray-700","mb-1"],["type","password","id","newPassword","name","newPassword","required","","minlength","8",1,"w-full","px-4","py-2","border","border-gray-300","rounded-lg","focus:ring-indigo-500","focus:border-indigo-500",3,"ngModelChange","ngModel"],[1,"text-xs","text-gray-500","mt-1"],["for","confirmPassword",1,"block","text-sm","font-medium","text-gray-700","mb-1"],["type","password","id","confirmPassword","name","confirmPassword","required","",1,"w-full","px-4","py-2","border","border-gray-300","rounded-lg","focus:ring-indigo-500","focus:border-indigo-500",3,"ngModelChange","ngModel"],[1,"text-gray-700"],[1,"text-sm","text-gray-500","mt-2"],[1,"mb-6"],[1,"px-3","py-1","rounded-full","text-sm","font-semibold",3,"ngClass"],[1,"space-y-4"],[1,"font-medium","text-gray-900"],["class","pt-4 border-t border-gray-200",4,"ngIf"],[1,"pt-4","border-t","border-gray-200"],[1,"w-full","px-4","py-2","bg-red-600","text-white","rounded-lg","hover:bg-red-700","focus:outline-none","transition-colors",3,"click"],["routerLink","/policies",1,"block","w-full","text-center","px-4","py-2","bg-indigo-600","text-white","rounded-lg","hover:bg-indigo-700","focus:outline-none","transition-colors"],[1,"text-center","py-8"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"h-12","w-12","mx-auto","text-gray-400","mb-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"],[1,"text-md","font-medium","text-gray-900","mb-2"],[1,"text-sm","text-gray-500","mb-6"]],template:function(e,a){e&1&&(x(0,"app-header"),i(1,"div",3)(2,"div",4)(3,"div",5)(4,"div",6)(5,"div")(6,"h1",7),r(7,"My Profile"),t(),i(8,"p",8),r(9,"Manage your account details and subscription"),t()()()(),g(10,Ee,2,0,"div",9)(11,qe,29,16,"div",10),t()(),x(12,"app-footer")),e&2&&(l(10),d("ngIf",a.isLoading),l(),d("ngIf",!a.isLoading))},dependencies:[M,O,N,re,B,j,L,A,R,pe,ue,le,ae,W,q],styles:[".loader[_ngcontent-%COMP%]{border:3px solid #f3f3f3;border-radius:50%;border-top:3px solid #4f46e5;width:40px;height:40px;animation:_ngcontent-%COMP%_spin 1s linear infinite;margin:0 auto}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}input[_ngcontent-%COMP%]:focus, select[_ngcontent-%COMP%]:focus, textarea[_ngcontent-%COMP%]:focus{outline:none;box-shadow:0 0 0 2px #4f46e533}input.ng-invalid.ng-touched[_ngcontent-%COMP%]{border-color:#ef4444}input.ng-invalid.ng-touched[_ngcontent-%COMP%]:focus{box-shadow:0 0 0 2px #ef444433}.transition-colors[_ngcontent-%COMP%]{transition:background-color .3s ease,color .3s ease,border-color .3s ease}.bg-white[_ngcontent-%COMP%]{transition:box-shadow .3s ease}.bg-white[_ngcontent-%COMP%]:hover{box-shadow:0 10px 15px -3px #0000001a,0 4px 6px -2px #0000000d}@media (max-width: 768px){.container[_ngcontent-%COMP%]{padding-left:1rem;padding-right:1rem}.grid[_ngcontent-%COMP%]{row-gap:1.5rem}}button[_ngcontent-%COMP%]:not([disabled]):hover{transform:translateY(-1px);transition:transform .2s ease}button[_ngcontent-%COMP%]:not([disabled]):active{transform:translateY(0)}"]})};var Y=$(xe());function Ge(n,o){n&1&&(i(0,"span"),r(1,"Description is required"),t())}function Ye(n,o){n&1&&(i(0,"span"),r(1,"Description must be at least 10 characters"),t())}function He(n,o){if(n&1&&(i(0,"div",24),g(1,Ge,2,0,"span",25)(2,Ye,2,0,"span",25),t()),n&2){let e,a,s=m(2);l(),d("ngIf",(e=s.submitClaimForm.get("description"))==null||e.errors==null?null:e.errors.required),l(),d("ngIf",(a=s.submitClaimForm.get("description"))==null||a.errors==null?null:a.errors.minlength)}}function ze(n,o){n&1&&(i(0,"span"),r(1,"Amount is required"),t())}function Je(n,o){n&1&&(i(0,"span"),r(1,"Amount must be greater than 0"),t())}function Ke(n,o){if(n&1&&(i(0,"div",24),g(1,ze,2,0,"span",25)(2,Je,2,0,"span",25),t()),n&2){let e,a,s=m(2);l(),d("ngIf",(e=s.submitClaimForm.get("amount"))==null||e.errors==null?null:e.errors.required),l(),d("ngIf",(a=s.submitClaimForm.get("amount"))==null||a.errors==null?null:a.errors.min)}}function Qe(n,o){if(n&1&&(i(0,"div",26),x(1,"img",27),t()),n&2){let e=m(2);l(),d("src",e.imagePreview,E)}}function Xe(n,o){if(n&1){let e=b();i(0,"div",2)(1,"h2",10),r(2,"Submit a New Claim"),t(),i(3,"form",11),_("ngSubmit",function(){p(e);let s=m();return u(s.submitClaim())}),i(4,"div")(5,"label",12),r(6,"Description"),t(),x(7,"textarea",13),g(8,He,3,2,"div",14),t(),i(9,"div")(10,"label",15),r(11,"Claim Amount"),t(),x(12,"input",16),g(13,Ke,3,2,"div",14),t(),i(14,"div")(15,"label",17),r(16,"Supporting Document/Image"),t(),i(17,"div",18),g(18,Qe,2,1,"div",19),i(19,"label",20)(20,"input",21),_("change",function(s){p(e);let c=m();return u(c.onFileSelected(s))}),t(),r(21),t()(),i(22,"p",22),r(23,"Upload an image or document to support your claim (receipts, medical reports, etc.)"),t()(),i(24,"div")(25,"button",23),r(26," Submit Claim "),t()()()()}if(n&2){let e,a,s=m();l(3),d("formGroup",s.submitClaimForm),l(5),d("ngIf",((e=s.submitClaimForm.get("description"))==null?null:e.invalid)&&((e=s.submitClaimForm.get("description"))==null?null:e.touched)),l(5),d("ngIf",((a=s.submitClaimForm.get("amount"))==null?null:a.invalid)&&((a=s.submitClaimForm.get("amount"))==null?null:a.touched)),l(5),d("ngIf",s.imagePreview),l(3),v(" ",s.imagePreview?"Change Image":"Upload Image"," ")}}function Ze(n,o){n&1&&(i(0,"div",28),x(1,"div",29),t())}function $e(n,o){if(n&1){let e=b();i(0,"tr")(1,"td",41)(2,"div",42),r(3),t()(),i(4,"td",43)(5,"div",44),r(6),t()(),i(7,"td",45),r(8),t(),i(9,"td",45),r(10),t(),i(11,"td",41)(12,"span",46),r(13),t()(),i(14,"td",47)(15,"button",48),_("click",function(){let s=p(e).$implicit,c=m(3);return u(c.viewClaimDetails(s.id))}),r(16,"Details"),t()()()}if(n&2){let e=o.$implicit,a=m(3);l(3),f(e.policyName),l(3),f(e.description),l(2),v(" ",a.formatCurrency(a.calculateRefundAmount(e))," "),l(2),v(" ",a.formatDate(e.createdAt)," "),l(2),d("ngClass",a.getStatusClass(e.status)),l(),v(" ",e.status," ")}}function et(n,o){if(n&1&&(i(0,"table",36)(1,"thead",37)(2,"tr")(3,"th",38),r(4,"Policy"),t(),i(5,"th",38),r(6,"Description"),t(),i(7,"th",38),r(8,"Refund Est."),t(),i(9,"th",38),r(10,"Date"),t(),i(11,"th",38),r(12,"Status"),t(),i(13,"th",38),r(14,"Actions"),t()()(),i(15,"tbody",39),g(16,$e,17,6,"tr",40),t()()),n&2){let e=m(2);l(16),d("ngForOf",e.claims)}}function tt(n,o){if(n&1){let e=b();i(0,"div",49),P(),i(1,"svg",50),x(2,"path",51),t(),I(),i(3,"h3",52),r(4,"No claims found"),t(),i(5,"p",53),r(6,"Get started by submitting a new claim."),t(),i(7,"div",54)(8,"button",55),_("click",function(){p(e);let s=m(2);return u(s.toggleSubmitForm())}),P(),i(9,"svg",56),x(10,"path",57),t(),r(11," Submit New Claim "),t()()()}}function it(n,o){if(n&1&&(i(0,"div",30)(1,"div",31)(2,"h2",32),r(3,"Your Claims History"),t()(),i(4,"div",33),g(5,et,17,1,"table",34)(6,tt,12,0,"div",35),t()()),n&2){let e=m();l(5),d("ngIf",e.claims.length>0),l(),d("ngIf",e.claims.length===0)}}function nt(n,o){if(n&1&&(i(0,"div")(1,"p",65),r(2,"Supporting Document"),t(),i(3,"div",71),x(4,"img",72),t()()),n&2){let e=m(2);l(4),d("src",e.getImageUrl(e.selectedClaim.image),E)}}function rt(n,o){if(n&1&&(i(0,"div",73)(1,"h3",74),r(2,"Refund Information"),t(),i(3,"div",75)(4,"div",76)(5,"div")(6,"p",65),r(7,"Refund Amount"),t(),i(8,"p",77),r(9),t()(),i(10,"div")(11,"p",65),r(12,"Reference"),t(),i(13,"p",66),r(14),t()(),i(15,"div")(16,"p",65),r(17,"Payment Status"),t(),i(18,"p",67)(19,"span",46),r(20),t()()()()()()),n&2){let e=m(2);l(9),f(e.formatCurrency(e.refund.amount)),l(5),f(e.refund.reference||"N/A"),l(5),d("ngClass",e.refund.isPaid?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"),l(),v(" ",e.refund.isPaid?"Paid":"Pending Payment"," ")}}function ot(n,o){n&1&&(i(0,"div",73)(1,"h3",74),r(2,"Refund Information"),t(),i(3,"div",78)(4,"p",79),r(5,"Your refund is being processed. Please check back later."),t()()())}function at(n,o){if(n&1){let e=b();i(0,"div",30)(1,"div",58)(2,"h2",32),r(3,"Claim Details"),t(),i(4,"button",59),_("click",function(){p(e);let s=m();return u(s.closeClaimDetails())}),P(),i(5,"svg",60),x(6,"path",61),t()()(),I(),i(7,"div",62)(8,"div",63)(9,"div",64)(10,"div")(11,"p",65),r(12,"Policy"),t(),i(13,"p",66),r(14),t()(),i(15,"div")(16,"p",65),r(17,"Date Filed"),t(),i(18,"p",66),r(19),t()(),i(20,"div")(21,"p",65),r(22,"Status"),t(),i(23,"p",67)(24,"span",46),r(25),t()()()(),i(26,"div",64)(27,"div")(28,"p",65),r(29,"Description"),t(),i(30,"p",66),r(31),t()(),g(32,nt,5,1,"div",25),t()(),g(33,rt,21,4,"div",68)(34,ot,6,0,"div",68),i(35,"div",69)(36,"button",70),_("click",function(){p(e);let s=m();return u(s.closeClaimDetails())}),r(37," Return to Claims List "),t()()()()}if(n&2){let e=m();l(14),f(e.selectedClaim.policyName),l(5),f(e.formatDate(e.selectedClaim.createdAt)),l(5),d("ngClass",e.getStatusClass(e.selectedClaim.status)),l(),v(" ",e.selectedClaim.status," "),l(6),f(e.selectedClaim.description),l(),d("ngIf",e.selectedClaim.image),l(),d("ngIf",e.refund),l(),d("ngIf",!e.refund&&e.selectedClaim.status==="APPROVED")}}var H=class n{constructor(o,e){this.claimService=o;this.fb=e;this.submitClaimForm=this.fb.group({description:["",[D.required,D.minLength(10)]],amount:["",[D.required,D.min(1)]]})}claims=[];isLoading=!0;submitClaimForm;showSubmitForm=!1;selectedFile=null;imagePreview=null;selectedClaimId=null;selectedClaim=null;refund=null;ngOnInit(){this.loadUserClaims()}loadUserClaims(){this.isLoading=!0,this.claimService.getAllClaimsByUser().subscribe({next:o=>{this.claims=o,this.isLoading=!1},error:o=>{console.error("Error loading claims:",o),this.isLoading=!1,Y.default.fire({title:"Error",text:"Failed to load your claims. Please try again later.",icon:"error"})}})}toggleSubmitForm(){this.showSubmitForm=!this.showSubmitForm,this.showSubmitForm||this.resetForm()}resetForm(){this.submitClaimForm.reset(),this.selectedFile=null,this.imagePreview=null}onFileSelected(o){let e=o.target;if(!e.files||e.files.length===0)return;this.selectedFile=e.files[0];let a=new FileReader;a.onload=()=>{this.imagePreview=a.result},a.readAsDataURL(this.selectedFile)}submitClaim(){if(this.submitClaimForm.invalid){Object.keys(this.submitClaimForm.controls).forEach(e=>{this.submitClaimForm.get(e)?.markAsTouched()});return}let o=new FormData;o.append("description",this.submitClaimForm.get("description")?.value),o.append("amount",this.submitClaimForm.get("amount")?.value),this.selectedFile&&o.append("image",this.selectedFile),this.claimService.submitClaimWithImage(o).subscribe({next:e=>{Y.default.fire({title:"Success",text:"Your claim has been submitted successfully!",icon:"success"}),this.toggleSubmitForm(),this.loadUserClaims()},error:e=>{console.error("Error submitting claim:",e);let a="Failed to submit your claim. Please try again later.";e.error&&typeof e.error=="string"&&(a=e.error),Y.default.fire({title:"Error",text:a,icon:"error"})}})}viewClaimDetails(o){this.isLoading=!0,this.selectedClaimId=o,this.selectedClaim=this.claims.find(e=>e.id===o)||null,setTimeout(()=>{this.selectedClaim?.status==="APPROVED"?this.refund={id:1,claimId:o,amount:250,reference:"REF-"+Math.floor(Math.random()*1e4),createdAt:new Date().toISOString(),isPaid:Math.random()>.5}:this.refund=null,this.isLoading=!1},500)}closeClaimDetails(){this.selectedClaimId=null,this.selectedClaim=null,this.refund=null}getStatusClass(o){switch(o?.toUpperCase()){case"APPROVED":return"bg-green-100 text-green-800";case"PENDING":return"bg-yellow-100 text-yellow-800";case"REJECTED":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}}formatCurrency(o){return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2}).format(o||0)}formatDate(o){if(!o)return"N/A";let e=new Date(o);return e.toLocaleDateString()+" "+e.toLocaleTimeString()}calculateRefundAmount(o){return!o||typeof o.id!="number"?0:o.id*50}getImageUrl(o){return o?this.claimService.getImageUrl(o):""}static \u0275fac=function(e){return new(e||n)(S(be),S(ge))};static \u0275cmp=V({type:n,selectors:[["app-user-claims"]],decls:17,vars:5,consts:[[1,"min-h-screen","bg-gray-50","py-8"],[1,"container","mx-auto","px-4"],[1,"bg-white","rounded-lg","shadow-md","p-6","mb-6"],[1,"flex","justify-between","items-center"],[1,"text-2xl","font-bold","text-gray-800"],[1,"text-gray-600"],[1,"px-4","py-2","bg-indigo-600","text-white","rounded-lg","hover:bg-indigo-700","focus:outline-none","transition-colors",3,"click"],["class","bg-white rounded-lg shadow-md p-6 mb-6",4,"ngIf"],["class","flex justify-center py-12",4,"ngIf"],["class","bg-white rounded-lg shadow-md overflow-hidden",4,"ngIf"],[1,"text-xl","font-semibold","text-gray-800","mb-4"],[1,"space-y-4",3,"ngSubmit","formGroup"],["for","description",1,"block","text-sm","font-medium","text-gray-700","mb-1"],["id","description","formControlName","description","rows","3","placeholder","Describe your claim in detail",1,"w-full","px-4","py-2","border","border-gray-300","rounded-lg","focus:ring-indigo-500","focus:border-indigo-500"],["class","text-red-500 text-sm mt-1",4,"ngIf"],["for","amount",1,"block","text-sm","font-medium","text-gray-700","mb-1"],["type","number","id","amount","formControlName","amount","min","1","placeholder","Enter claim amount",1,"w-full","px-4","py-2","border","border-gray-300","rounded-lg","focus:ring-indigo-500","focus:border-indigo-500"],[1,"block","text-sm","font-medium","text-gray-700","mb-1"],[1,"flex","items-center","space-x-4"],["class","h-24 w-24 rounded-lg overflow-hidden",4,"ngIf"],[1,"cursor-pointer","px-4","py-2","bg-gray-100","text-gray-700","rounded-lg","hover:bg-gray-200","transition-colors"],["type","file","accept","image/*",1,"hidden",3,"change"],[1,"text-xs","text-gray-500","mt-1"],["type","submit",1,"w-full","py-2","px-4","border","border-transparent","shadow-sm","text-sm","font-medium","rounded-md","text-white","bg-indigo-600","hover:bg-indigo-700","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-indigo-500"],[1,"text-red-500","text-sm","mt-1"],[4,"ngIf"],[1,"h-24","w-24","rounded-lg","overflow-hidden"],["alt","Selected image preview",1,"h-full","w-full","object-cover",3,"src"],[1,"flex","justify-center","py-12"],[1,"animate-spin","rounded-full","h-12","w-12","border-t-2","border-b-2","border-indigo-500"],[1,"bg-white","rounded-lg","shadow-md","overflow-hidden"],[1,"px-6","py-4","border-b","border-gray-200"],[1,"text-lg","font-semibold","text-gray-700"],[1,"overflow-x-auto"],["class","min-w-full divide-y divide-gray-200",4,"ngIf"],["class","text-center py-8",4,"ngIf"],[1,"min-w-full","divide-y","divide-gray-200"],[1,"bg-gray-50"],["scope","col",1,"px-6","py-3","text-left","text-xs","font-medium","text-gray-500","uppercase","tracking-wider"],[1,"bg-white","divide-y","divide-gray-200"],[4,"ngFor","ngForOf"],[1,"px-6","py-4","whitespace-nowrap"],[1,"text-sm","font-medium","text-gray-900"],[1,"px-6","py-4"],[1,"text-sm","text-gray-900","truncate","max-w-xs"],[1,"px-6","py-4","whitespace-nowrap","text-sm","text-gray-500"],[1,"px-2","inline-flex","text-xs","leading-5","font-semibold","rounded-full",3,"ngClass"],[1,"px-6","py-4","whitespace-nowrap","text-right","text-sm","font-medium"],[1,"text-indigo-600","hover:text-indigo-900",3,"click"],[1,"text-center","py-8"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"h-12","w-12","mx-auto","text-gray-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"],[1,"mt-2","text-sm","font-medium","text-gray-900"],[1,"mt-1","text-sm","text-gray-500"],[1,"mt-6"],[1,"inline-flex","items-center","px-4","py-2","border","border-transparent","shadow-sm","text-sm","font-medium","rounded-md","text-white","bg-indigo-600","hover:bg-indigo-700","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-indigo-500",3,"click"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 20 20","fill","currentColor",1,"-ml-1","mr-2","h-5","w-5"],["fill-rule","evenodd","d","M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z","clip-rule","evenodd"],[1,"px-6","py-4","border-b","border-gray-200","flex","justify-between","items-center"],[1,"text-gray-400","hover:text-gray-500",3,"click"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"h-5","w-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M6 18L18 6M6 6l12 12"],[1,"p-6"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-6"],[1,"space-y-4"],[1,"text-sm","font-medium","text-gray-500"],[1,"mt-1","text-sm","text-gray-900"],[1,"mt-1"],["class","mt-8 pt-6 border-t border-gray-200",4,"ngIf"],[1,"mt-6","text-center"],[1,"px-4","py-2","bg-gray-100","text-gray-700","rounded-lg","hover:bg-gray-200","focus:outline-none","transition-colors",3,"click"],[1,"mt-2"],["alt","Claim evidence",1,"max-h-48","rounded-md",3,"src"],[1,"mt-8","pt-6","border-t","border-gray-200"],[1,"text-lg","font-semibold","text-gray-800","mb-4"],[1,"bg-green-50","border","border-green-200","rounded-lg","p-4"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-4"],[1,"mt-1","text-lg","font-semibold","text-gray-900"],[1,"bg-yellow-50","border","border-yellow-200","rounded-lg","p-4","text-center"],[1,"text-sm","text-yellow-700"]],template:function(e,a){e&1&&(x(0,"app-header"),i(1,"div",0)(2,"div",1)(3,"div",2)(4,"div",3)(5,"div")(6,"h1",4),r(7,"My Claims"),t(),i(8,"p",5),r(9,"View your insurance claims and their status"),t()(),i(10,"button",6),_("click",function(){return a.toggleSubmitForm()}),r(11),t()()(),g(12,Xe,27,5,"div",7)(13,Ze,2,0,"div",8)(14,it,7,2,"div",9)(15,at,38,8,"div",9),t()(),x(16,"app-footer")),e&2&&(l(11),v(" ",a.showSubmitForm?"Cancel":"Submit New Claim"," "),l(),d("ngIf",a.showSubmitForm),l(),d("ngIf",a.isLoading),l(),d("ngIf",!a.isLoading&&!a.selectedClaimId),l(),d("ngIf",!a.isLoading&&a.selectedClaimId&&a.selectedClaim))},dependencies:[M,O,ne,N,F,B,j,L,se,A,R,ce,fe,de,me,W,q],styles:[".animate-spin[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_spin 1s linear infinite}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}@media (max-width: 768px){.overflow-x-auto[_ngcontent-%COMP%]{margin:0 -1rem}table[_ngcontent-%COMP%]{min-width:100%}th[_ngcontent-%COMP%], td[_ngcontent-%COMP%]{padding-left:.5rem!important;padding-right:.5rem!important}}.image-preview[_ngcontent-%COMP%]{transition:transform .2s}.image-preview[_ngcontent-%COMP%]:hover{transform:scale(1.05)}input[_ngcontent-%COMP%]:focus, select[_ngcontent-%COMP%]:focus, textarea[_ngcontent-%COMP%]:focus{outline:2px solid #4f46e5;outline-offset:2px}button[_ngcontent-%COMP%]{transition:all .2s}button[_ngcontent-%COMP%]:active{transform:scale(.98)}"]})};var lt=[{path:"profile",component:G},{path:"claims",component:H}],z=class n{static \u0275fac=function(e){return new(e||n)};static \u0275mod=U({type:n});static \u0275inj=T({imports:[F.forChild(lt),F]})};var ye=class n{static \u0275fac=function(e){return new(e||n)};static \u0275mod=U({type:n});static \u0275inj=T({imports:[M,z]})};export{ye as UserModule};
